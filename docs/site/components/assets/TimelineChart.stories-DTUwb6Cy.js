import{r as C,j as p}from"./index-B-j1UC9_.js";import{s as D,z as V,i as _}from"./zoom-BhWAVBVM.js";import{v as H,s as P,z as B}from"./linear-BBABVEQd.js";import{S}from"./decorators-CfDSmGYB.js";import{i as T}from"./chart-data-BkDdS-S9.js";import"./string-Quv1MC-p.js";function O(a){return a}var W=1,N=1e-6;function I(a){return"translate("+a+",0)"}function X(a){return r=>+a(r)}function q(a,r){return r=Math.max(0,a.bandwidth()-r*2)/2,a.round()&&(r=Math.round(r)),i=>+a(i)+r}function G(){return!this.__axis}function J(a,r){var i=[],o=null,d=null,f=6,y=6,A=3,g=typeof window<"u"&&window.devicePixelRatio>1?0:.5,x=-1,j="y",s=I;function n(e){var c=o??(r.ticks?r.ticks.apply(r,i):r.domain()),L=d??(r.tickFormat?r.tickFormat.apply(r,i):O),b=Math.max(f,0)+A,M=r.range(),l=+M[0]+g,F=+M[M.length-1]+g,E=(r.bandwidth?q:X)(r.copy(),g),z=e.selection?e.selection():e,v=z.selectAll(".domain").data([null]),h=z.selectAll(".tick").data(c,r).order(),t=h.exit(),u=h.enter().append("g").attr("class","tick"),m=h.select("line"),k=h.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),h=h.merge(u),m=m.merge(u.append("line").attr("stroke","currentColor").attr(j+"2",x*f)),k=k.merge(u.append("text").attr("fill","currentColor").attr(j,x*b).attr("dy","0em")),e!==z&&(v=v.transition(e),h=h.transition(e),m=m.transition(e),k=k.transition(e),t=t.transition(e).attr("opacity",N).attr("transform",function(Y){return isFinite(Y=E(Y))?s(Y+g):this.getAttribute("transform")}),u.attr("opacity",N).attr("transform",function(Y){var w=this.parentNode.__axis;return s((w&&isFinite(w=w(Y))?w:E(Y))+g)})),t.remove(),v.attr("d",y?"M"+l+","+x*y+"V"+g+"H"+F+"V"+x*y:"M"+l+","+g+"H"+F),h.attr("opacity",1).attr("transform",function(Y){return s(E(Y)+g)}),m.attr(j+"2",x*f),k.attr(j,x*b).text(L),z.filter(G).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),z.each(function(){this.__axis=E})}return n.scale=function(e){return arguments.length?(r=e,n):r},n.ticks=function(){return i=Array.from(arguments),n},n.tickArguments=function(e){return arguments.length?(i=e==null?[]:Array.from(e),n):i.slice()},n.tickValues=function(e){return arguments.length?(o=e==null?null:Array.from(e),n):o&&o.slice()},n.tickFormat=function(e){return arguments.length?(d=e,n):d},n.tickSize=function(e){return arguments.length?(f=y=+e,n):f},n.tickSizeInner=function(e){return arguments.length?(f=+e,n):f},n.tickSizeOuter=function(e){return arguments.length?(y=+e,n):y},n.tickPadding=function(e){return arguments.length?(A=+e,n):A},n.offset=function(e){return arguments.length?(g=+e,n):g},n}function K(a){return J(W,a)}function $({entries:a,minYear:r,maxYear:i,onNodeClick:o,resetSignal:d}){const f=C.useRef(null),y=C.useRef(null),A=C.useRef();return C.useEffect(()=>{var h;if(!f.current||!y.current||a.length===0)return;const x=y.current.clientWidth,j=40,s={top:60,right:40,bottom:40,left:200},n=Math.max(400,s.top+a.length*j+s.bottom);D(f.current).selectAll("*").remove();const e=D(f.current).attr("width",x).attr("height",n).attr("viewBox",[0,0,x,n]),c=e.append("g"),L=V().scaleExtent([.5,4]).on("zoom",t=>{c.attr("transform",t.transform.toString())});e.call(L);const b=new Date().getFullYear(),M=Math.max(i,b),l=H().domain([r-5,M+5]).range([s.left,x-s.right]),F=P().domain(a.map(t=>t.id)).range([s.top,n-s.bottom]).padding(.2),E=K(l).tickFormat(t=>t.toString()).ticks(Math.min(20,M-r));c.append("g").attr("class","x-axis").attr("transform",`translate(0, ${s.top})`).call(E).selectAll("text").style("fill","var(--color-foreground)").style("font-size","11px"),c.selectAll(".x-axis path, .x-axis line").style("stroke","var(--color-border)");const z=B(Math.ceil(r/10)*10,M+1,10);c.append("g").attr("class","grid-lines").selectAll("line").data(z).enter().append("line").attr("x1",t=>l(t)).attr("x2",t=>l(t)).attr("y1",s.top).attr("y2",n-s.bottom).style("stroke","var(--color-border)").style("stroke-width","1px").style("stroke-dasharray","3,3").style("opacity",.5),c.append("line").attr("x1",l(b)).attr("x2",l(b)).attr("y1",s.top).attr("y2",n-s.bottom).style("stroke","var(--color-primary)").style("stroke-width","2px").style("stroke-dasharray","5,5"),c.append("text").attr("x",l(b)).attr("y",s.top-25).attr("text-anchor","middle").style("fill","var(--color-primary)").style("font-size","10px").style("font-weight","600").text("Today"),a.forEach(t=>{const u=F(t.id);if(u===void 0)return;const m=F.bandwidth(),k=t.birthYear??r,Y=t.isLiving?b:t.deathYear??k+1;if(t.birthYear!==null){const w=Math.max(4,l(Y)-l(k));c.append("rect").attr("x",l(k)).attr("y",u).attr("width",w).attr("height",m).attr("rx",4).style("fill",t.isLiving?"color-mix(in oklch, var(--color-primary) 60%, transparent)":"var(--color-muted)").style("stroke",t.isLiving?"var(--color-primary)":"var(--color-border)").style("stroke-width","1px").style("cursor","pointer").on("mouseenter",function(){D(this).transition().duration(200).style("fill","var(--color-accent)")}).on("mouseleave",function(){D(this).transition().duration(200).style("fill",t.isLiving?"color-mix(in oklch, var(--color-primary) 60%, transparent)":"var(--color-muted)")}).on("click",()=>o==null?void 0:o(t.id)),c.append("circle").attr("cx",l(k)).attr("cy",u+m/2).attr("r",4).style("fill","var(--color-primary)").style("stroke","var(--color-background)").style("stroke-width","2px"),!t.isLiving&&t.deathYear&&c.append("circle").attr("cx",l(t.deathYear)).attr("cy",u+m/2).attr("r",4).style("fill","var(--color-muted-foreground)").style("stroke","var(--color-background)").style("stroke-width","2px")}if(c.append("text").attr("x",s.left-10).attr("y",u+m/2).attr("dy","0.35em").attr("text-anchor","end").style("fill","var(--color-foreground)").style("font-size","12px").style("font-weight","500").style("cursor","pointer").text(`${t.firstName} ${t.lastName}`).on("click",()=>o==null?void 0:o(t.id)),t.birthYear!==null){const w=t.isLiving?`${t.birthYear} - present`:t.deathYear?`${t.birthYear} - ${t.deathYear}`:`b. ${t.birthYear}`,R=Math.max(4,l(t.isLiving?b:t.deathYear??t.birthYear+1)-l(t.birthYear));R>80&&c.append("text").attr("x",l(t.birthYear)+R/2).attr("y",u+m/2).attr("dy","0.35em").attr("text-anchor","middle").style("fill","var(--color-foreground)").style("font-size","10px").style("font-weight","600").style("pointer-events","none").text(w)}c.append("circle").attr("cx",s.left-180).attr("cy",u+m/2).attr("r",4).style("fill",t.isLiving?"var(--color-primary)":"var(--color-muted-foreground)"),t.gender&&c.append("text").attr("x",s.left-160).attr("y",u+m/2).attr("dy","0.35em").style("fill","var(--color-muted-foreground)").style("font-size","10px").text(t.gender==="MALE"?"M":t.gender==="FEMALE"?"F":"-")});const v=(h=c.node())==null?void 0:h.getBBox();if(v){const t=Math.min(x/(v.width+40),n/(v.height+40),1),u=_.translate(20,20).scale(t);e.transition().duration(750).call(L.transform,u),A.current=()=>{e.transition().duration(300).call(L.transform,u)}}},[a,r,i,o]),C.useEffect(()=>{d!==void 0&&A.current&&A.current()},[d]),p.jsx("div",{ref:y,className:"bg-card relative h-full w-full overflow-hidden rounded-lg border",children:p.jsx("svg",{ref:f,className:"h-full w-full"})})}const lt={title:"Charts/TimelineChart"},Q=()=>{const a=T(8),r=a.filter(d=>d.birthYear).map(d=>d.birthYear),i=Math.min(...r),o=Math.max(...a.map(d=>d.deathYear||new Date().getFullYear()));return p.jsx(S,{children:p.jsx($,{entries:a,minYear:i,maxYear:o,onNodeClick:d=>console.log("Clicked:",d)})})};Q.storyName="Default - Standard timeline";const U=()=>{const a=T(10);return p.jsx(S,{children:p.jsx($,{entries:a.slice(0,10),minYear:1900,maxYear:2e3,onNodeClick:o=>console.log("Clicked:",o)})})};U.storyName="Century - 100 years of data";const Z=()=>{const a=T(20);return p.jsx(S,{children:p.jsx($,{entries:a,minYear:1700,maxYear:2e3,onNodeClick:o=>console.log("Clicked:",o)})})};Z.storyName="Three Centuries - 300 years span";const tt=()=>{const a=T(5).map(r=>({...r,birthYear:null,deathYear:null}));return p.jsx(S,{children:p.jsx($,{entries:a,minYear:1900,maxYear:2e3,onNodeClick:r=>console.log("Clicked:",r)})})};tt.storyName="No Dates - People without dates";const rt=()=>{const a=new Date().getFullYear(),r=T(8).map(i=>({...i,birthYear:i.birthYear||a-40,isLiving:!0,deathYear:null}));return p.jsx(S,{children:p.jsx($,{entries:r,minYear:a-80,maxYear:a,onNodeClick:i=>console.log("Clicked:",i)})})};rt.storyName="All Living - Only living people";typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{rt as AllLiving,U as Century,Q as Default,tt as NoDates,Z as ThreeCenturies,lt as default};
