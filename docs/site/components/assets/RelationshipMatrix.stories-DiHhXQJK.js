import{r as m,j as r}from"./index-B-j1UC9_.js";import{s as S,z,i as C}from"./zoom-BhWAVBVM.js";import{S as f}from"./decorators-CfDSmGYB.js";import{g as x}from"./chart-data-BkDdS-S9.js";import"./string-Quv1MC-p.js";const G={SELF:"var(--color-primary)",PARENT:"var(--color-chart-1)",CHILD:"var(--color-chart-2)",SPOUSE:"var(--color-chart-3)",SIBLING:"var(--color-chart-4)",PARENT_IN_LAW:"var(--color-chart-5)",CHILD_IN_LAW:"var(--color-chart-1)",SIBLING_IN_LAW:"var(--color-chart-2)",STEP_PARENT:"var(--color-chart-3)",STEP_CHILD:"var(--color-chart-4)",STEP_SIBLING:"var(--color-chart-5)"},T={SELF:"-",PARENT:"P",CHILD:"C",SPOUSE:"S",SIBLING:"Sb",PARENT_IN_LAW:"PIL",CHILD_IN_LAW:"CIL",SIBLING_IN_LAW:"SIL",STEP_PARENT:"SP",STEP_CHILD:"SC",STEP_SIBLING:"SS"};function u({people:s,matrix:l,onNodeClick:a,resetSignal:i}){const d=m.useRef(null),v=m.useRef(null),L=m.useRef();return m.useEffect(()=>{var D;if(!d.current||!v.current||s.length===0)return;const b=v.current,n=40,w=150,o={top:100,right:40,bottom:40,left:w},g=s.length*n,P=Math.max(b.clientWidth,o.left+g+o.right),_=o.top+g+o.bottom;S(d.current).selectAll("*").remove();const y=S(d.current).attr("width",P).attr("height",_).attr("viewBox",[0,0,P,_]),h=y.append("g"),E=z().scaleExtent([.3,3]).on("zoom",t=>{h.attr("transform",t.transform.toString())});y.call(E);const R=new Map;l.forEach(t=>{R.set(`${t.personId}-${t.relatedPersonId}`,t)});const M=h.append("g").attr("class","grid");s.forEach((t,p)=>{s.forEach((c,N)=>{const e=R.get(`${t.id}-${c.id}`),H=o.left+N*n,W=o.top+p*n,j=M.append("g").attr("class","cell").attr("transform",`translate(${H}, ${W})`).style("cursor",e!=null&&e.relationshipType?"pointer":"default");j.append("rect").attr("width",n).attr("height",n).style("fill",e!=null&&e.relationshipType?G[e.relationshipType]||"var(--color-muted)":"var(--color-background)").style("stroke","var(--color-border)").style("stroke-width","1px").style("opacity",e!=null&&e.relationshipType?.7:.3).on("mouseenter",function(){e!=null&&e.relationshipType&&S(this).transition().duration(200).style("opacity",1)}).on("mouseleave",function(){S(this).transition().duration(200).style("opacity",e!=null&&e.relationshipType?.7:.3)}).on("click",()=>{t.id!==c.id&&(a==null||a(t.id))}),e!=null&&e.relationshipType&&e.relationshipType!=="SELF"&&j.append("text").attr("x",n/2).attr("y",n/2).attr("dy","0.35em").attr("text-anchor","middle").style("fill","var(--color-foreground)").style("font-size","9px").style("font-weight","600").style("pointer-events","none").text(T[e.relationshipType]||"?"),e!=null&&e.relationshipType&&j.append("title").text(e.relationshipType==="SELF"?"Self":T[e.relationshipType]?`${T[e.relationshipType]} (${e.relationshipType.replace(/_/g," ")})`:e.relationshipType)})});const $=h.append("g").attr("class","row-labels");s.forEach((t,p)=>{const c=o.top+p*n+n/2;$.append("text").attr("x",o.left-10).attr("y",c).attr("dy","0.35em").attr("text-anchor","end").style("fill","var(--color-foreground)").style("font-size","11px").style("font-weight","500").style("cursor","pointer").text(`${t.firstName} ${t.lastName}`.substring(0,18)).on("click",()=>a==null?void 0:a(t.id)).append("title").text(`${t.firstName} ${t.lastName}`),$.append("circle").attr("cx",o.left-w+10).attr("cy",c).attr("r",4).style("fill",t.gender==="MALE"?"var(--color-chart-1)":t.gender==="FEMALE"?"var(--color-chart-3)":"var(--color-muted-foreground)")});const B=h.append("g").attr("class","col-labels");s.forEach((t,p)=>{const c=o.left+p*n+n/2;B.append("text").attr("x",c).attr("y",o.top-10).attr("text-anchor","start").attr("transform",`rotate(-45, ${c}, ${o.top-10})`).style("fill","var(--color-foreground)").style("font-size","11px").style("font-weight","500").style("cursor","pointer").text(`${t.firstName} ${t.lastName}`.substring(0,15)).on("click",()=>a==null?void 0:a(t.id)).append("title").text(`${t.firstName} ${t.lastName}`)});const A=h.append("g").attr("class","grid-lines");for(let t=0;t<=s.length;t++)A.append("line").attr("x1",o.left).attr("x2",o.left+g).attr("y1",o.top+t*n).attr("y2",o.top+t*n).style("stroke","var(--color-border)").style("stroke-width","1px");for(let t=0;t<=s.length;t++)A.append("line").attr("x1",o.left+t*n).attr("x2",o.left+t*n).attr("y1",o.top).attr("y2",o.top+g).style("stroke","var(--color-border)").style("stroke-width","1px");const I=(D=h.node())==null?void 0:D.getBBox();if(I){const t=b.clientWidth,p=Math.max(600,b.clientHeight),c=Math.min(t/(I.width+40),p/(I.height+40),1),N=C.translate(20,20).scale(c);y.transition().duration(750).call(E.transform,N),L.current=()=>{y.transition().duration(300).call(E.transform,N)}}},[s,l,a]),m.useEffect(()=>{i!==void 0&&L.current&&L.current()},[i]),r.jsxs("div",{ref:v,className:"bg-card relative h-full w-full overflow-hidden rounded-lg border",children:[r.jsx("svg",{ref:d,className:"h-full w-full"}),r.jsxs("div",{className:"bg-card/90 absolute right-4 bottom-4 rounded-lg border p-3 backdrop-blur-sm",children:[r.jsx("p",{className:"text-foreground mb-2 text-xs font-semibold",children:"Relationship Legend"}),r.jsxs("div",{className:"grid grid-cols-2 gap-1 text-[10px]",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"font-mono",children:"P"}),r.jsx("span",{className:"text-muted-foreground",children:"Parent"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"font-mono",children:"C"}),r.jsx("span",{className:"text-muted-foreground",children:"Child"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"font-mono",children:"S"}),r.jsx("span",{className:"text-muted-foreground",children:"Spouse"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"font-mono",children:"Sb"}),r.jsx("span",{className:"text-muted-foreground",children:"Sibling"})]})]})]})]})}const Z={title:"Charts/RelationshipMatrix"},k=()=>{const{people:s,matrix:l}=x(10);return r.jsx(f,{children:r.jsx(u,{people:s,matrix:l,onNodeClick:a=>console.log("Clicked:",a)})})};k.storyName="Default - Standard matrix (10x10)";const F=()=>{const{people:s,matrix:l}=x(5);return r.jsx(f,{children:r.jsx(u,{people:s,matrix:l,onNodeClick:a=>console.log("Clicked:",a)})})};F.storyName="Small - Few people (5x5)";const J=()=>{const{people:s,matrix:l}=x(20);return r.jsx(f,{children:r.jsx(u,{people:s,matrix:l,onNodeClick:a=>console.log("Clicked:",a)})})};J.storyName="Large - Many people (20x20)";const U=()=>{const{people:s,matrix:l}=x(8),a=s.map((i,d)=>({...i,firstName:d%3===0?"John":d%3===1?"Jane":"Bob",lastName:d%2===0?"Smith":"Johnson"}));return r.jsx(f,{children:r.jsx(u,{people:a,matrix:l,onNodeClick:i=>console.log("Clicked:",i)})})};U.storyName="Duplicate Names - Same names, different people";const O=()=>{const{people:s,matrix:l}=x(6),a=l.map(i=>({...i,relationshipType:i.personId===i.relatedPersonId?"SELF":null,strength:i.personId===i.relatedPersonId?1:0}));return r.jsx(f,{children:r.jsx(u,{people:s,matrix:a,onNodeClick:i=>console.log("Clicked:",i)})})};O.storyName="No Relationships - Unconnected people";typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{k as Default,U as DuplicateNames,J as Large,O as NoRelationships,F as Small,Z as default};
